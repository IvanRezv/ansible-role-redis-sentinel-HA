# Example sentinel.conf configuration location
# /etc/redis/sentinel.conf
daemonize {{ protected_mode }}
{% if supervised_mode == "yes" %}
supervised systemd
{% endif %}
dir {{ sentinel_dir }}
pidfile {{ sentinel_pid }}
logfile {{ sentinel_logfile }}
protected-mode {{ protected_mode }}
{% if sentinel_requirepass !== "" %}
requirepass {{ sentinel_requirepass }}
{% endif %}
bind {{ ansible_default_ipv4 }} {{ sentinel_bind_loop }}
#bind {{ sentinel_child_interface }} {{ sentinel_bind_loop }}
port {{ sentinel_port }}
{% if sentinel_deny_scripts_reconfig == "yes" %}
sentinel deny-scripts-reconfig {{ sentinel_deny_scripts_reconfig }}
{% endif %}
sentinel monitor {{ redis_node_name }} {{ redis_parent_ip }} {{ redis_parent_port}} {{ sentinel_quorum }}
sentinel down-after-milliseconds {{ redis_parent_name }} {{ sentinel_down_ms }}
sentinel failover-timeout {{ redis_parent_name }} {{ sentinel_failtime }}
sentinel auth-pass {{ redis_parent_name }} {{ sentinel_auth-pass }}

# Generated by CONFIG REWRITE

{% for host in groups["redis"] %}
{% if hostvars[host]["redis-tag"] == parent %}
replicaof {{ ansible_default_ipv4.address }} {{ redis_parent_port }}
{% endif %}
{% endfor %}
