- name: Add TCP PORT {{ redis_port }}
  iptables:
    chain: INPUT
    protocol: tcp
    jump: ACCEPT
    destination_port: "{{ redis_port }}"
  become: true
  when: ansible_distribution == 'RedHat'

- name: Add TCP PORT {{ sentinel_port }}
  iptables:
    chain: INPUT
    protocol: tcp
    jump: ACCEPT
    destination_port: "{{ sentinel_port }}"
  become: true
  when: ansible_distribution == 'RedHat'

- name: ADD FIREWALLD TCP PORT {{ redis_port }}
  firewalld:
   port: "{{ redis_port }}/tcp"
   zone: public
   permanent: true
   state: enabled
  become: true
  when: ansible_distribution == 'CentOS' and ansible_distribution_major_version|int <= 7

- name: ADD FIREWALLD TCP PORT {{ sentinel_port }}
  firewalld:
   port: "{{ sentinel_port }}/tcp"
   zone: public
   permanent: true
   state: enabled
  become: true
  when: ansible_distribution == 'CentOS' and ansible_distribution_major_version|int <= 7

- name: RELOAD FIREWALL
  command: firewall-cmd --reload
  become: true
